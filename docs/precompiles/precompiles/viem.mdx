---
title: 'Viem'
description: 'Using @sei-js/precompiles with Viem for type-safe precompile contract interactions'
icon: "code"
---

## Precompiles with Viem

The `@sei-js/precompiles` package provides comprehensive Viem integration with typed ABIs, precompile addresses, and utilities specifically designed for Sei's precompile contracts.

## Installation

<CodeGroup>

```bash npm
npm install @sei-js/precompiles viem
```

```bash yarn
yarn add @sei-js/precompiles viem
```

```bash pnpm
pnpm add @sei-js/precompiles viem
```

</CodeGroup>

## Basic Setup

```typescript
import { createPublicClient, createWalletClient, http } from 'viem';
import { 
  BANK_PRECOMPILE_ADDRESS,
  ORACLE_PRECOMPILE_ADDRESS,
  bankPrecompileAbi,
  oraclePrecompileAbi
} from '@sei-js/precompiles';

// Create clients
const publicClient = createPublicClient({
  chain: seiLocal, // or your preferred Sei network
  transport: http()
});

const walletClient = createWalletClient({
  chain: seiLocal,
  transport: http()
});
```

## Import Patterns

### Individual Precompile Imports

```typescript
// Import specific precompile ABIs and addresses
import { 
  BANK_PRECOMPILE_ADDRESS,
  bankPrecompileAbi,
  ORACLE_PRECOMPILE_ADDRESS,
  oraclePrecompileAbi 
} from '@sei-js/precompiles';
```

### Bulk Imports

```typescript
// Import multiple precompiles at once
import {
  // Bank
  BANK_PRECOMPILE_ADDRESS,
  bankPrecompileAbi,
  
  // Oracle
  ORACLE_PRECOMPILE_ADDRESS,
  oraclePrecompileAbi
} from '@sei-js/precompiles';
```

## Basic Usage Examples

### Reading from Precompiles

```typescript
import { 
  BANK_PRECOMPILE_ADDRESS,
  bankPrecompileAbi 
} from '@sei-js/precompiles';

// Get token balance
const balance = await publicClient.readContract({
  address: BANK_PRECOMPILE_ADDRESS,
  abi: bankPrecompileAbi,
  functionName: 'balance',
  args: ['0x...', 'usei']
});

console.log('Balance:', balance.toString());
```

### Writing to Precompiles

```typescript
import { 
  ORACLE_PRECOMPILE_ADDRESS,
  oraclePrecompileAbi 
} from '@sei-js/precompiles';
import { parseEther } from 'viem';

// Delegate tokens
const hash = await walletClient.writeContract({
  address: ORACLE_PRECOMPILE_ADDRESS,
  abi: oraclePrecompileAbi,
  functionName: 'delegate',
  args: ['seivaloper...', parseEther('100')],
  account: '0x...'
});

// Wait for transaction
const receipt = await publicClient.waitForTransactionReceipt({ hash });
```

## Contract Instances

Create reusable contract instances:

```typescript
import { getContract } from 'viem';

// Create contract instance
const bankContract = getContract({
  address: BANK_PRECOMPILE_ADDRESS,
  abi: bankPrecompileAbi,
  client: { public: publicClient, wallet: walletClient }
});

// Use contract instance
const balance = await bankContract.read.balance(['0x...', 'usei']);
const hash = await bankContract.write.send(['0x...', parseEther('10'), 'usei']);
```

## Multicall Batching

Batch multiple precompile calls efficiently:

```typescript
import { 
  BANK_PRECOMPILE_ADDRESS,
  bankPrecompileAbi,
  ORACLE_PRECOMPILE_ADDRESS,
  oraclePrecompileAbi 
} from '@sei-js/precompiles';

const results = await publicClient.multicall({
  contracts: [
    {
      address: BANK_PRECOMPILE_ADDRESS,
      abi: bankPrecompileAbi,
      functionName: 'balance',
      args: ['0x...', 'usei']
    },
    {
      address: ORACLE_PRECOMPILE_ADDRESS,
      abi: oraclePrecompileAbi,
      functionName: 'getExchangeRate',
      args: ['uatom']
    }
  ]
});

console.log('Balance:', results[0].result?.toString());
console.log('ATOM Rate:', results[1].result?.toString());
```

## Event Watching

Listen to precompile events:

```typescript
// Watch for bank transfers
const unwatch = publicClient.watchContractEvent({
  address: BANK_PRECOMPILE_ADDRESS,
  abi: bankPrecompileAbi,
  eventName: 'Transfer',
  onLogs: (logs) => {
    logs.forEach((log) => {
      console.log('Transfer:', {
        from: log.args.from,
        to: log.args.to,
        amount: log.args.amount?.toString(),
        denom: log.args.denom
      });
    });
  }
});

// Stop watching
// unwatch();
```

## Error Handling

```typescript
import { BaseError, ContractFunctionRevertedError } from 'viem';

try {
  const hash = await walletClient.writeContract({
    address: ORACLE_PRECOMPILE_ADDRESS,
    abi: oraclePrecompileAbi,
    functionName: 'delegate',
    args: ['seivaloper...', parseEther('100')],
    account: '0x...'
  });
} catch (err) {
  if (err instanceof BaseError) {
    const revertError = err.walk(err => err instanceof ContractFunctionRevertedError);
    if (revertError instanceof ContractFunctionRevertedError) {
      console.error('Contract reverted:', revertError.data?.errorName);
    }
  }
}
```

## Type Safety

All precompile ABIs are fully typed for TypeScript:

```typescript
// TypeScript will infer correct types
const balance = await publicClient.readContract({
  address: BANK_PRECOMPILE_ADDRESS,
  abi: bankPrecompileAbi,
  functionName: 'balance', // Autocomplete available
  args: ['0x...', 'usei']   // Args are type-checked
});
// balance is typed as bigint
```

## Best Practices

1. **Use Contract Instances** for repeated interactions
2. **Batch Calls** with multicall for efficiency  
3. **Handle Errors** gracefully with proper error types
4. **Use Viem's utilities** like `parseEther` for amount formatting
5. **Type Safety** - leverage TypeScript for better DX

## Next Steps

<CardGroup cols={2}>
  <Card
    title="Complete Reference"
    icon="book"
    href="/precompiles/precompiles/reference"
  >
    View all precompile contracts, addresses, and functions
  </Card>
  <Card
    title="Ethers.js Integration"
    icon="code"
    href="/precompiles/precompiles/ethers"
  >
    Use precompiles with Ethers.js
  </Card>
</CardGroup>
